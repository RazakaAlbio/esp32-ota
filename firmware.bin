#include <WiFi.h>
#include <HTTPUpdate.h>

// Ganti sesuai WiFi kamu
const char* ssid = "RUMAH";
const char* password = "caberg2010";

// Ganti sesuai dengan URL file .bin dari GitHub Releases (harus langsung link ke file)
const char* firmware_url = "https://raw.githubusercontent.com/RazakaAlbio/esp32-ota/refs/heads/main/firmware.bin";

void setup() {
  Serial.begin(115200);
  delay(1000);

  Serial.println("Menghubungkan ke WiFi...");
  WiFi.begin(ssid, password);
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }
  Serial.println("\nTerhubung ke WiFi!");
  Serial.print("IP Address: ");
  Serial.println(WiFi.localIP());

  // Lakukan update firmware
  Serial.println("Cek pembaruan firmware...");
  t_httpUpdate_return result = httpUpdate.update(firmware_url);

  switch (result) {
    case HTTP_UPDATE_FAILED:
      Serial.printf("Update gagal. Error (%d): %s\n", 
                    httpUpdate.getLastError(),
                    httpUpdate.getLastErrorString().c_str());
      break;

    case HTTP_UPDATE_NO_UPDATES:
      Serial.println("Tidak ada pembaruan firmware.");
      break;

    case HTTP_UPDATE_OK:
      Serial.println("Pembaruan berhasil! Perangkat akan restart...");
      break;
  }
}

void loop() {
  Serial.println("BISAAAA JANCOKKKK!!!");
}
